!function(e,t){"function"==typeof define&&define.amd?define(["jQuery"],t):t("object"==typeof exports?require("jQuery"):e.jQuery)}(this,function(){var e=function(){var e={},t=4,n=new RegExp("{{([^}]+)}}","g"),s=function(e){for(var t,s=[];t=n.exec(e);)s.push(t);return s};return e.parse=function(e){var n={inpts:{},chars:{}},r=s(e),i=e.length,a=0,h=0,o=0,c=function(e){for(var s=e.length,r=0;s>r;r++)n.inpts[h]=e.charAt(r),h++;a++,o+=e.length+t-1};for(o;i>o;o++)a<r.length&&o===r[a].index?c(r[a][1]):n.chars[o-a*t]=e.charAt(o);return n.mLength=o-a*t,n},e}(),t=function(){var e={};return"undefined"!=typeof navigator?navigator.userAgent:null,e.extend=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e},e.addChars=function(e,t,n){return e.substr(0,n)+t+e.substr(n,e.length)},e.removeChars=function(e,t,n){return e.substr(0,t)+e.substr(n,e.length)},e.isBetween=function(e,t){return t.sort(function(e,t){return e-t}),e>t[0]&&e<t[1]},e.addListener=function(e,t,n){return"undefined"!=typeof e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},e.preventDefault=function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1},e.getClip=function(e){return e.clipboardData?e.clipboardData.getData("Text"):window.clipboardData?window.clipboardData.getData("Text"):void 0},e.getMatchingKey=function(e,t,n){for(var s in n){var r=n[s];if(e===r.which&&t===r.keyCode)return s}},e.isDelKeyDown=function(t,n){var s={backspace:{which:8,keyCode:8},"delete":{which:46,keyCode:46}};return e.getMatchingKey(t,n,s)},e.isDelKeyPress=function(t,n){var s={backspace:{which:8,keyCode:8,shiftKey:!1},"delete":{which:0,keyCode:46}};return e.getMatchingKey(t,n,s)},e.isSpecialKeyPress=function(t,n){var s={tab:{which:0,keyCode:9},enter:{which:13,keyCode:13},end:{which:0,keyCode:35},home:{which:0,keyCode:36},leftarrow:{which:0,keyCode:37},uparrow:{which:0,keyCode:38},rightarrow:{which:0,keyCode:39},downarrow:{which:0,keyCode:40},F5:{which:116,keyCode:116}};return e.getMatchingKey(t,n,s)},e.isModifier=function(e){return e.ctrlKey||e.altKey||e.metaKey},e.forEach=function(e,t,n){if(e.hasOwnProperty("length"))for(var s=0,r=e.length;r>s&&t.call(n,e[s],s,e)!==!1;s++);else for(var i in e)if(e.hasOwnProperty(i)&&t.call(n,e[i],i,e)===!1)break},e}(),n=function(e,t){function n(n){var r=[],i=[];t.forEach(n,function(n){t.forEach(n,function(t,n){var a=e.parse(t),h=s(n);return r.push(h),i.push(a),!1})});var a=function(e){var n;return t.forEach(r,function(t,s){return t.test(e)?(n=s,!1):void 0}),void 0===n?null:i[n]};return{getPattern:a,patterns:i,matchers:r}}var s=function(e){return"*"===e?/.*/:new RegExp(e)};return n}(e,t),s=function(){var e={};return e.get=function(e){if("number"==typeof e.selectionStart)return{begin:e.selectionStart,end:e.selectionEnd};var t=document.selection.createRange();if(t&&t.parentElement()===e){var n=e.createTextRange(),s=e.createTextRange(),r=e.value.length;return n.moveToBookmark(t.getBookmark()),s.collapse(!1),n.compareEndPoints("StartToEnd",s)>-1?{begin:r,end:r}:{begin:-n.moveStart("character",-r),end:-n.moveEnd("character",-r)}}return{begin:0,end:0}},e.set=function(e,t){if("object"!=typeof t&&(t={begin:t,end:t}),e.setSelectionRange)e.focus(),e.setSelectionRange(t.begin,t.end);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t.end),n.moveStart("character",t.begin),n.select()}},e}(),r=function(e,t,n){function s(t,s){var i=this;if(i.el=t,!i.el)throw new TypeError("Must provide an existing element");if(i.opts=n.extend({},r,s),"undefined"!=typeof i.opts.pattern&&(i.opts.patterns=i._specFromSinglePattern(i.opts.pattern),delete i.opts.pattern),"undefined"==typeof i.opts.patterns)throw new TypeError("Must provide a pattern or array of patterns");i.patternMatcher=e(i.opts.patterns),i._updatePattern(),i.hldrs={},i.focus=0,n.addListener(i.el,"keydown",function(e){i._keyDown(e)}),n.addListener(i.el,"keypress",function(e){i._keyPress(e)}),n.addListener(i.el,"paste",function(e){i._paste(e)}),i.opts.persistent&&(i._processKey("",!1),i.el.blur(),n.addListener(i.el,"focus",function(e){i._focus(e)}),n.addListener(i.el,"click",function(e){i._focus(e)}),n.addListener(i.el,"touchstart",function(e){i._focus(e)}))}var r={persistent:!1,repeat:!1,placeholder:" "},i={9:/[0-9]/,a:/[A-Za-z]/,"*":/[A-Za-z0-9]/};return s.addInptType=function(e,t){i[e]=t},s.prototype.resetPattern=function(n){this.opts.patterns=n?this._specFromSinglePattern(n):this.opts.patterns,this.sel=t.get(this.el),this.val=this.el.value,this.delta=0,this._removeChars(),this.patternMatcher=e(this.opts.patterns);var s=this.patternMatcher.getPattern(this.val);this.mLength=s.mLength,this.chars=s.chars,this.inpts=s.inpts,this._processKey("",!1,!0)},s.prototype._updatePattern=function(){var e=this.patternMatcher.getPattern(this.val);e&&(this.mLength=e.mLength,this.chars=e.chars,this.inpts=e.inpts)},s.prototype._keyDown=function(e){var t=e.which||e.keyCode;return t&&n.isDelKeyDown(e.which,e.keyCode)?(this._processKey(null,t),n.preventDefault(e)):void 0},s.prototype._keyPress=function(e){var t,s;return t=e.which||e.keyCode,s=n.isSpecialKeyPress(e.which,e.keyCode),n.isDelKeyPress(e.which,e.keyCode)||s||n.isModifier(e)?void 0:(this._processKey(String.fromCharCode(t),!1),n.preventDefault(e))},s.prototype._paste=function(e){return this._processKey(n.getClip(e),!1),n.preventDefault(e)},s.prototype._focus=function(){var e=this;setTimeout(function(){var n=t.get(e.el),s=n.end>e.focus,r=0===n.end;(s||r)&&t.set(e.el,e.focus)},0)},s.prototype._processKey=function(e,s,r){if(this.sel=t.get(this.el),this.val=this.el.value,this.delta=0,this.sel.begin!==this.sel.end)this.delta=-1*Math.abs(this.sel.begin-this.sel.end),this.val=n.removeChars(this.val,this.sel.begin,this.sel.end);else if(s&&46===s)this._delete();else if(s&&this.sel.begin-1>=0)this.val=n.removeChars(this.val,this.sel.end-1,this.sel.end),this.delta-=1;else if(s)return!0;s||(this.val=n.addChars(this.val,e,this.sel.begin),this.delta+=e.length),this._formatValue(r)},s.prototype._delete=function(){for(;this.chars[this.sel.begin];)this._nextPos();this.sel.begin<this.val.length&&(this._nextPos(),this.val=n.removeChars(this.val,this.sel.end-1,this.sel.end),this.delta=-1)},s.prototype._nextPos=function(){this.sel.end++,this.sel.begin++},s.prototype._formatValue=function(e){this.newPos=this.sel.end+this.delta,this._removeChars(),this._updatePattern(),this._validateInpts(),this._addChars(),this.el.value=this.val.substr(0,this.mLength),("undefined"==typeof e||e===!1)&&t.set(this.el,this.newPos)},s.prototype._removeChars=function(){this.sel.end>this.focus&&(this.delta+=this.sel.end-this.focus);for(var e=0,t=0;t<=this.mLength;t++){var s,r=this.chars[t],i=this.hldrs[t],a=t+e;a=t>=this.sel.begin?a+this.delta:a,s=this.val.charAt(a),(r&&r===s||i&&i===s)&&(this.val=n.removeChars(this.val,a,a+1),e--)}this.hldrs={},this.focus=this.val.length},s.prototype._validateInpts=function(){for(var e=0;e<this.val.length;e++){var t=this.inpts[e],s=!i[t],r=!s&&!i[t].test(this.val.charAt(e)),a=this.inpts[e];(s||r)&&a&&(this.val=n.removeChars(this.val,e,e+1),this.focusStart--,this.newPos--,this.delta--,e--)}},s.prototype._addChars=function(){if(this.opts.persistent){for(var e=0;e<=this.mLength;e++)this.val.charAt(e)||(this.val=n.addChars(this.val,this.opts.placeholder,e),this.hldrs[e]=this.opts.placeholder),this._addChar(e);for(;this.chars[this.focus];)this.focus++}else for(var t=0;t<=this.val.length;t++){if(this.delta<=0&&t===this.focus)return!0;this._addChar(t)}},s.prototype._addChar=function(e){var t=this.chars[e];return t?(n.isBetween(e,[this.sel.begin-1,this.newPos+1])&&(this.newPos++,this.delta++),e<=this.focus&&this.focus++,this.hldrs[e]&&(delete this.hldrs[e],this.hldrs[e+1]=this.opts.placeholder),void(this.val=n.addChars(this.val,t,e))):!0},s.prototype._specFromSinglePattern=function(e){return[{"*":e}]},s}(n,s,t),i="formatter";$.fn[i]=function(e){return"object"==typeof e&&this.each(function(){$.data(this,"plugin_"+i)||$.data(this,"plugin_"+i,new r(this,e))}),this.resetPattern=function(e){return this.each(function(){var t=$.data(this,"plugin_"+i);t&&t.resetPattern(e)}),this},this},$.fn[i].addInptType=function(e,t){r.addInptType(e,t)}});